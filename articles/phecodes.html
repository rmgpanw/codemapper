<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phecodes • codemapper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Phecodes">
<meta property="og:description" content="codemapper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">codemapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/codemapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/caliber.html">CALIBER code lists</a>
    </li>
    <li>
      <a href="../articles/icd10_formats.html">ICD10 code formats</a>
    </li>
    <li>
      <a href="../articles/map_codes.html">Mapping between clinical coding systems</a>
    </li>
    <li>
      <a href="../articles/phecodes.html">Phecodes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rmgpanw/codemapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="phecodes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Phecodes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rmgpanw/codemapper/blob/HEAD/vignettes/phecodes.Rmd" class="external-link"><code>vignettes/phecodes.Rmd</code></a></small>
      <div class="hidden name"><code>phecodes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rmgpanw/codemapper" class="external-link">codemapper</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="va">all_lkps_maps_dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/build_all_lkps_maps_dummy.html">build_all_lkps_maps_dummy</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A phenome-wide association study analyses associations between a single genetic (or non-genetic) exposure across a number of phenotypes. One way to perform this is by using phecodes.<span class="citation">[@denny2016; @wu2019]</span></p>
<p>This vignette outlines one approach for mapping UK Biobank clinical codes to phecodes.</p>
</div>
<div class="section level2">
<h2 id="map-uk-biobank-clinical-events-to-phecodes">Map UK Biobank clinical events to phecodes<a class="anchor" aria-label="anchor" href="#map-uk-biobank-clinical-events-to-phecodes"></a>
</h2>
<p>A UK Biobank clinical events table created by <code><a href="https://rdrr.io/pkg/ukbwranglr/man/tidy_clinical_events.html" class="external-link">ukbwranglr::tidy_clinical_events()</a></code> may be mapped to Phecodes using <code><a href="../reference/map_clinical_events_to_phecodes.html">map_clinical_events_to_phecodes()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dummy clinical events data frame</span>
<span class="va">dummy_clinical_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dummy_clinical_events_tidy.html">dummy_clinical_events_tidy</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># map to Phecodes</span>
<span class="va">clinical_events_phecodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_clinical_events_to_phecodes.html">map_clinical_events_to_phecodes</a></span><span class="op">(</span>clinical_events <span class="op">=</span> <span class="va">dummy_clinical_events</span>,
                                                            all_lkps_maps <span class="op">=</span> <span class="va">all_lkps_maps_dummy</span>,
                                                            min_date_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Identified the following 5 data sources to map to phecodes: [1] **Death register** - Underlying (primary) cause of death, [2] **Death register** - Contributory (secondary) cause of death, [3] **Primary care** - `read_2` column, data provider England (Vision), [4] **Primary care** - `read_3` column, data provider England (TPP), [5] **Summary Diagnoses - Hospital inpatient - Health-related outcomes** - Diagnoses - ICD9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ***MAPPING clinical_events TO PHECODES***</span>
<span class="co">#&gt; [1] **Death register** - Underlying (primary) cause of death</span>
<span class="co">#&gt; [2] **Death register** - Contributory (secondary) cause of death</span>
<span class="co">#&gt; [3] **Primary care** - `read_2` column, data provider England (Vision)</span>
<span class="co">#&gt; [4] **Primary care** - `read_3` column, data provider England (TPP)</span>
<span class="co">#&gt; [5] **Summary Diagnoses - Hospital inpatient - Health-related outcomes** - Diagnoses - ICD9</span>
<span class="co">#&gt; Time taken: 0 minutes, 0 seconds.</span>

<span class="va">clinical_events_phecodes</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="co">#&gt;     eid source  index code  date       icd10 phecode</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 f40001  0_0   <span style="color: #BB0000;">NA</span>    1917-10-08 I10   401.1  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 f40002  0_0   <span style="color: #BB0000;">NA</span>    1955-02-11 E109  250.1  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 gpc3_r3 3     XaIP9 1917-10-08 L721  706.2  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1 gpc3_r3 3     XaIP9 1917-10-08 L721  704    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1 gpc3_r3 3     XE0Uc 1917-10-08 I10   401.1  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1 f41271  0_0   4019  1910-02-19 I10   401.1</span></code></pre></div>
<p>ICD10 codes are mapped directly to phecodes, while non-ICD10 sources are mapped to phecodes via ICD10. Use the <code>col_filters</code> argument to determine which code mappings to include (see <code>vignette(map_codes)</code> for further details).</p>
<p>The following data sources (if present in the clinical events data frame) are included in the mapping:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="8%">
<col width="32%">
<col width="43%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">source</th>
<th align="left">data_coding</th>
<th align="left">description</th>
<th align="left">category</th>
<th align="left">file</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">f40001</td>
<td align="left">icd10</td>
<td align="left">Underlying (primary) cause of death</td>
<td align="left">Death register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f40002</td>
<td align="left">icd10</td>
<td align="left">Contributory (secondary) cause of death</td>
<td align="left">Death register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f20002_icd10</td>
<td align="left">icd10</td>
<td align="left">Non-cancer illness code, self-reported</td>
<td align="left">Medical conditions</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f40013</td>
<td align="left">icd9</td>
<td align="left">Type of cancer: ICD9</td>
<td align="left">Cancer register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f40006</td>
<td align="left">icd10</td>
<td align="left">Type of cancer: ICD10</td>
<td align="left">Cancer register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f41270</td>
<td align="left">icd10</td>
<td align="left">Diagnoses - ICD10</td>
<td align="left">Summary Diagnoses - Hospital inpatient - Health-related outcomes</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f41271</td>
<td align="left">icd9</td>
<td align="left">Diagnoses - ICD9</td>
<td align="left">Summary Diagnoses - Hospital inpatient - Health-related outcomes</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">gpc1_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider England (Vision)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc2_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider Scotland</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="even">
<td align="left">gpc3_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider England (TPP)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc4_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider Wales</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="even">
<td align="left">gpc1_r3</td>
<td align="left">read3</td>
<td align="left">
<code>read_3</code> column, data provider England (Vision)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc2_r3</td>
<td align="left">read3</td>
<td align="left">
<code>read_3</code> column, data provider Scotland</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="even">
<td align="left">gpc3_r3</td>
<td align="left">read3</td>
<td align="left">
<code>read_3</code> column, data provider England (TPP)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc4_r3</td>
<td align="left">read3</td>
<td align="left">
<code>read_3</code> column, data provider Wales</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
</tbody>
</table>
<p>This may be reformatted for running a phenome-wide association study using the <a href="https://github.com/PheWAS/PheWAS" class="external-link">PheWAS package</a></p>
</div>
<div class="section level2">
<h2 id="reverse-mapping">Reverse mapping<a class="anchor" aria-label="anchor" href="#reverse-mapping"></a>
</h2>
<p>Ideally all Read and ICD9 code to phecode mappings should be manually checked prior to their use. At the very least, any findings of interest should be manually reviewed to ascertain exactly which clinical codes were used. Use <code><a href="../reference/make_phecode_reverse_map.html">make_phecode_reverse_map()</a></code> to achieve this</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/make_phecode_reverse_map.html">make_phecode_reverse_map</a></span><span class="op">(</span>clinical_events_phecodes <span class="op">=</span> <span class="va">clinical_events_phecodes</span>,
                           all_lkps_maps <span class="op">=</span> <span class="va">all_lkps_maps_dummy</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Time taken: 0 minutes, 0 seconds.</span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="20%">
<col width="6%">
<col width="3%">
<col width="27%">
<col width="9%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left">phecode</th>
<th align="left">phecode_description</th>
<th align="left">data_coding</th>
<th align="left">code</th>
<th align="left">description</th>
<th align="left">icd10_equivalent</th>
<th align="left">icd10_description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">icd10</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
<tr class="even">
<td align="left">250.1</td>
<td align="left">Type 1 diabetes</td>
<td align="left">icd10</td>
<td align="left">E109</td>
<td align="left">Type 1 diabetes mellitus Without complications</td>
<td align="left">E109</td>
<td align="left">Type 1 diabetes mellitus Without complications</td>
</tr>
<tr class="odd">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">icd9</td>
<td align="left">4019</td>
<td align="left">ESSENTIAL HYPERTENSION NOT SPECIFIED</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
<tr class="even">
<td align="left">706.2</td>
<td align="left">Sebaceous cyst</td>
<td align="left">read3</td>
<td align="left">XaIP9</td>
<td align="left">Sebaceous cyst</td>
<td align="left">L721</td>
<td align="left">Trichilemmal cyst</td>
</tr>
<tr class="odd">
<td align="left">704</td>
<td align="left">Diseases of hair and hair follicles</td>
<td align="left">read3</td>
<td align="left">XaIP9</td>
<td align="left">Sebaceous cyst</td>
<td align="left">L721</td>
<td align="left">Trichilemmal cyst</td>
</tr>
<tr class="even">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">read3</td>
<td align="left">XE0Uc</td>
<td align="left">Essential hypertension</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alasdair Warwick.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
